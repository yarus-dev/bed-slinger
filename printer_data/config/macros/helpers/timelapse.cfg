[gcode_macro TIMELAPSE_START]
gcode:
  RESPOND PREFIX=timelapse MSG=start

[gcode_macro TIMELAPSE_PAUSE]
gcode:
  RESPOND PREFIX=timelapse MSG=pause

[gcode_macro TIMELAPSE_RESUME]
gcode:
  RESPOND PREFIX=timelapse MSG=resume

[gcode_macro TIMELAPSE_END]
gcode:
  RESPOND PREFIX=timelapse MSG=stop
  RESPOND PREFIX=timelapse MSG=create

[gcode_macro TIMELAPSE_SHOOT]
description: Take Timelapse shoot
variable_delay_before: 500
variable_delay_after: 1500
variable_pause: 0
variable_park: 0
gcode:


[gcode_macro TIMELAPSE_RESUME_PRINT]
gcode:
  {% set travel_speed = printer.toolhead.max_velocity|int %}
  {% set delay_after = printer["gcode_macro TIMELAPSE_CAPTURE"].delay_after|float %}
  G4 P{delay_after}
  BASE_RESUME VELOCITY={travel_speed}

[gcode_macro TIMELAPSE_SET_CAPTURE_PARAMS]
gcode:
  {% for p in params %}
  SET_GCODE_VARIABLE MACRO=TIMELAPSE_CAPTURE VARIABLE={p|lower} VALUE={params[p]}
  RESPOND MSG="Set {p|lower} to {params[p]}"
  {% endfor %}

[gcode_macro TIMELAPSE_SET_PARAMS]
gcode:
  RESPOND PREFIX=set_timelapse_params MSG="{rawparams}"

[gcode_macro TIMELAPSE_SET_NOTIFY_PARAMS]
gcode:
  RESPOND PREFIX=set_notify_params MSG="{rawparams}"