[gcode_macro HEATSOAK_BED]
description: Heatsoak bed at specified temperature and wait for a specific amount of time
gcode:
    {% set TARGET = params.TARGET|default(0)|int %}
    {% set PERIOD = params.PERIOD|default(6)|int %}

    {% if PERIOD > 0 and TARGET > 0  %}
        RESPOND MSG="Heating up bed..."

        M190 S{TARGET}

        {% for time_left in range(PERIOD, 1) %}
            RESPOND MSG="Heatsoak bed, {time_left}mn left..."
            G4 P{60000}
        {% endfor %}

        RESPOND MSG="Bed temperature OK"
    {% else %}
        RESPOND MSG="No heatsoak needed, continue"
    {% endif %}


    